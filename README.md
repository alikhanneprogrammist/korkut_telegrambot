# Telegram Sales Bot - –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ –¥–ª—è –∏–ø–æ—Ç–µ—á–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞

Telegram –±–æ—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª —Å –ø–æ–ª–Ω–æ–π –≤–æ—Ä–æ–Ω–∫–æ–π –ø—Ä–æ–¥–∞–∂ –∏ —Å–∏—Å—Ç–µ–º–æ–π —Ä–µ—Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥–∞.

## üéØ –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂

### –≠—Ç–∞–ø—ã –≤–æ—Ä–æ–Ω–∫–∏:

1. **START** - –°—Ç–∞—Ä—Ç–æ–≤–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
   - –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –∫–∞–Ω–∞–ª–∞
   - –ö–Ω–æ–ø–∫–∞: ¬´–•–æ—á—É¬ª

2. **–•–û–ß–£** - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
   - –°–ø–∏—Å–æ–∫ —Ç–æ–≥–æ, —á—Ç–æ –∂–¥—ë—Ç –≤ –∫–∞–Ω–∞–ª–µ
   - –ö–Ω–æ–ø–∫–∞: ¬´–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ¬ª

3. **–í–û–ü–†–û–°–´** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –°–±–æ—Ä –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–≤–æ–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
   - –ê–≤—Ç–æ–æ—Ç–≤–µ—Ç —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –ø–æ–¥–ø–∏—Å–∫–∏
   - –ö–Ω–æ–ø–∫–∏: ¬´–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É¬ª / ¬´–£–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ¬ª

4. **–ü–û–î–†–û–ë–ù–ï–ï** - –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
   - –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
   - –°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏
   - –ö–Ω–æ–ø–∫–∏: ¬´–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ¬ª / ¬´–ù–∞–∑–∞–¥¬ª

5. **–û–ü–õ–ê–¢–ê** - –ü—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã
   - –°—Å—ã–ª–∫–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É —á–µ—Ä–µ–∑ Robokassa
   - –ö–Ω–æ–ø–∫–∞: ¬´–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É¬ª

6. **–ü–û–°–õ–ï –û–ü–õ–ê–¢–´** - –£—Å–ø–µ—à–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞
   - –ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ
   - –°—Å—ã–ª–∫–∞ –Ω–∞ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª

### –†–µ—Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è):

- **24 —á–∞—Å–∞** - –ü–µ—Ä–≤–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –ø–æ–¥–ø–∏—Å–∫–µ
- **48 —á–∞—Å–æ–≤** - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ –∫–∞–Ω–∞–ª–∞
- **72 —á–∞—Å–∞** - –§–∏–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ

## üí≥ –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Robokassa

–ë–æ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å –ø–ª–∞—Ç—ë–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π Robokassa –¥–ª—è –ø—Ä–∏—ë–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ.

## üìä Postgres –∫–∞–∫ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Postgres:
- **users** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–æ—Ä–æ–Ω–∫–∏
- **subscriptions** ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–µ/–∏—Å—Ç—ë–∫—à–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
- **payments** ‚Äî –ø–ª–∞—Ç–µ–∂–∏
- **questions** ‚Äî –≤–æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install python-telegram-bot robokassa python-dotenv sqlalchemy psycopg2-binary
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Robokassa:

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [robokassa.ru](https://robokassa.ru)
2. –°–æ–∑–¥–∞–π—Ç–µ –º–∞–≥–∞–∑–∏–Ω
3. –ü–æ–ª—É—á–∏—Ç–µ Merchant Login –∏ –ø–∞—Ä–æ–ª–∏
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ URL-–∞–¥—Ä–µ—Å–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### 2.1. –í–µ–±—Ö—É–∫ Result URL Robokassa
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—É–∂–µ –≤ requirements): `fastapi`, `uvicorn`.
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–µ–±—Ö—É–∫-—Å–µ—Ä–≤–µ—Ä:
   ```bash
   uvicorn webhook:app --host 0.0.0.0 --port 8000
   ```
3. –í –∫–∞–±–∏–Ω–µ—Ç–µ Robokassa —É–∫–∞–∂–∏—Ç–µ:
   - Result URL: `https://<–≤–∞—à-–¥–æ–º–µ–Ω>/robokassa/result` (–º–µ—Ç–æ–¥ POST, MD5)
   - Success URL: –≤–∞—à–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞/–≥–ª—É–±–æ–∫–∞—è —Å—Å—ã–ª–∫–∞ (GET)
   - Fail URL: –≤–∞—à–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞/–≥–ª—É–±–æ–∫–∞—è —Å—Å—ã–ª–∫–∞ (GET)
4. –î–ª—è —Ç–µ—Å—Ç–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ngrok: `ngrok http 8000`, –∏ –≤—Å—Ç–∞–≤–∏—Ç—å HTTPS —Å—Å—ã–ª–∫—É –≤ Result URL.

### 3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
```env
# Telegram
TELEGRAM_TOKEN=your_bot_token
CHANNEL_ID=-1001234567890
CHANNEL_LINK=https://t.me/+invite_link
ADMIN_ID=your_telegram_id

# Robokassa
ROBOKASSA_MERCHANT_LOGIN=your_merchant_login
ROBOKASSA_PASSWORD_1=your_password_1
ROBOKASSA_PASSWORD_2=your_password_2
ROBOKASSA_TEST_MODE=True

# –ü–æ–¥–ø–∏—Å–∫–∞
SUBSCRIPTION_PRICE=20000

# Postgres
DATABASE_URL=postgresql+psycopg2://korkut:Aman123!@localhost:5432/telegram_sales
```

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
```bash
python bot.py
```

## üìù –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- `/start` - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º (–∑–∞–ø—É—Å–∫ –≤–æ—Ä–æ–Ω–∫–∏)
- `/subscribe` - –ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ –æ–ø–ª–∞—Ç–µ
- `/check` - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
- `/account` - –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π
- `/unsubscribe` - –û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–ø–ª–∞—Ç—ë–∂/—Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–π –ø–ª–∞—Ç–µ–∂
- `/help` - –°–ø—Ä–∞–≤–∫–∞

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
- `/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞ –∏ –≤–æ—Ä–æ–Ω–∫–∏
- `/confirm_payment <user_id> <inv_id>` - –†—É—á–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–æ—Ä–æ–Ω–∫–∏

–ö–æ–º–∞–Ω–¥–∞ `/stats` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ê–∫—Ç–∏–≤–Ω—ã–µ –∏ –∏—Å—Ç–µ–∫—à–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç–µ–∂–µ–π
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ —ç—Ç–∞–ø–∞–º –≤–æ—Ä–æ–Ω–∫–∏

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤

–í—Å–µ —Ç–µ–∫—Å—Ç—ã –≤–æ—Ä–æ–Ω–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Å–ª–æ–≤–∞—Ä–µ `TEXTS` –≤ —Ñ–∞–π–ª–µ `bot.py`. 
–í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∏—Ö –ø–æ–¥ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç.

## üîß –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –∫–∞–Ω–∞–ª–∞
- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º Robokassa
- –†–µ—Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ job queue)
- –í–æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Robokassa (—Ç–µ—Å—Ç–æ–≤—ã–π/–±–æ–µ–≤–æ–π —Ä–µ–∂–∏–º)
3. –ü—Ä–∞–≤–∞ –±–æ—Ç–∞ –≤ –∫–∞–Ω–∞–ª–µ
4. –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
